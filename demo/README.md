# Overview

This repository contains the elPrep demo files:

Demo 1:

* [run-wes-chr22.sh]: a bash script that runs a preparation pipeline fom the GATK best practices (sort, mark duplicates, bqsr) on "NA12878-chr22", a subset of [whole-exome sequencing of  NA12878](ftp://ftp-trace.ncbi.nih.gov/giab/ftp/data/NA12878/Garvan_NA12878_HG001_HiSeq_Exome/) that maps to chromosome 22 and was aligned using bwa mem against hg19

Demo 2:

* [run-wes.sh]: a bash script that runs a preparation pipeline from the GATK best practices (sort, mark duplicates, bqsr) on a [whole-exome sequencing of NA12878](ftp://ftp-trace.ncbi.nih.gov/giab/ftp/data/NA12878/Garvan_NA12878_HG001_HiSeq_Exome/) that was aligned using bwa mem against hg19



Other scripts:

* [clean.sh]: a bash script for deleting the output files generated by executing the pipeline scripts

Upon executing one of the run scripts for the first time, the following input files are downloaded:

* [NA12878.exome.hg19.chr22.bam]: a subset of [whole-exome sequencing of NA12878](ftp://ftp-trace.ncbi.nih.gov/giab/ftp/data/NA12878/Garvan_NA12878_HG001_HiSeq_Exome/) that maps to chromosome 22, created using BWA (136MB).
* [NA12878.exome.hg19.bam]: a [whole-exome sequencing of NA12878](ftp://ftp-trace.ncbi.nih.gov/giab/ftp/data/NA12878/Garvan_NA12878_HG001_HiSeq_Exome/) mapped using BWA (7.6GB). This is a complete, real-world workload.
* [hg19.elfasta]: an hg19 reference file in the elPrep-specific elfasta format. This file was generated from the hg19 fasta file in the GATK bundle.
* [Mills\_and\_1000G\_gold\_standard.indels.hg19.elsites and dbsnp\_137.hg19.elsites]: These files contain known variant sites for base quality score recalibration, and are in the elPrep-specific elsites format. These files were generated from the vcf files with known sites in the GATK bundle.
* [nexterarapidcapture\_expandedexome\_targetedregions.bed]: a bed file containing the regions captured in the exome.


Alternatively, you can also download these files manually [here](http://www.exascience.com/public-files/elprep-demo/).

# Running the demos

We recommend using NA12878.exome.hg19.chr22.bam for quick testing and checking that the installation of elPrep is correct. NA12878.exome.hg19.bam can be used for performance checks when running elPrep on a server.

## Path setup

Copy the elPrep binary on your machine add it to your path. For example, fill in your username and execute:

	export PATH=$PATH:/home/username/tools/elprep4.0:


## Demo 1: a workload for testing installation (NA12878.exome.hg19.chr22.bam)

The script run-wes-chr22.sh execute a prepartion pipeline from the GATK Best Practices that consists of sorting, duplicate marking, and base quality score recalibration and application.

1) By default, the scripts use the maximum number of available threads, based on your processor's capabilities. If you want to use a different number of threads, edit the scripts to do so.

2) Run the scripts by executing:

	sh run-wes-chr22.sh 	

On our test machine equipped with two 18-core Intel Xeon E5-2699v3 Haswell Processors clocked at 2.3Ghz, 256GB RAM, and 2x400GB SSD disks, we see following runtimes and resource use:

	 Runtime: 	23s
	 RAM: 		4,15GB
	 Disk: 		111MB


## Demo 2: a preparation pipeline from the GATK best practices on whole-exome data (NA12878.exome.hg19.bam)

The script run-wes.sh execute a prepartion pipeline from the GATK Best Practices that consists of sorting, duplicate marking, and base quality score recalibration and application.

1) By default, the scripts use the maximum number of available threads, based on your processor's capabilities. If you want to use a different number of threads, edit the scripts to do so.

2) Run the scripts by executing:

	sh run-wes.sh 	

On our test machine equipped with two 18-core Intel Xeon E5-2699v3 Haswell Processors clocked at 2.3Ghz, 256GB RAM, and 2x400GB SSD disks, we see following runtimes and resource use:

	 Runtime: 	10m 58s
	 RAM: 		23GB
	 Disk: 		15,5GB
		
## Resetting the demos

To remove the output files generated by executing the demos, execute the clean script:

	sh clean.sh
